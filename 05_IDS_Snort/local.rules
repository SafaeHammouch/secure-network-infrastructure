# ---------------- LOCAL RULES ----------------

# T7.1 - Détection de Scan Nmap (ICMP Echo Request - Ping Scan)
# On détecte si quelqu'un ping le réseau.
alert icmp any any -> any any (msg:"ALERTE: Scan Nmap/Ping detecte"; sid:1000001; rev:1; classtype:attempted-recon;)

# T7.2 - Détection Brute-force SSH (Port 2222 comme tu l'as configuré)
# Si plus de 5 tentatives de connexion en 60 secondes depuis la même IP.
alert tcp any any -> any 2222 (msg:"ALERTE: Tentative Brute-force SSH"; flags:S; flow:stateless; detection_filter:track by_src, count 5, seconds 60; sid:1000002; rev:1; classtype:suspicious-login;)

# T7.3 - Détection Attaque Web (Tentative d'accès à /etc/passwd)
# On cherche la chaine "/etc/passwd" dans le trafic HTTP vers la DMZ.
# Note : Cela ne fonctionne que sur le port 80 (avant redirection HTTPS) ou si tu déchiffres le SSL (complexe).
# Pour le projet, on teste sur le port 80.
alert tcp any any -> any 80 (msg:"ALERTE: Attaque Web Detectee (/etc/passwd)"; content:"/etc/passwd"; nocase; sid:1000003; rev:1; classtype:web-application-attack;)
