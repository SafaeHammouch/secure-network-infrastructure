# ========================================
# Configuration Snort minimale - Zero Trust IDS
# ========================================

# --- Variables réseau ---
ipvar HOME_NET [10.0.0.0/8,192.168.0.0/16]
ipvar EXTERNAL_NET !$HOME_NET

# Zones spécifiques
ipvar DMZ_NET 10.0.1.0/24
ipvar LAN_NET 10.0.2.0/24
ipvar VPN_NET 10.0.3.0/24
ipvar ADMIN_NET 10.0.4.0/24

# Ports des services
portvar HTTP_PORTS 80
portvar HTTPS_PORTS 443
portvar SSH_PORTS [22,2222]

# --- Configuration de base ---
config logdir: /var/log/snort
config detection: search-method ac-split search-optimize max-pattern-len 20
config event_queue: max_queue 8 log 5 order_events content_length

# --- Décodeurs ---
config disable_decode_alerts
config disable_tcpopt_experimental_alerts
config disable_tcpopt_obsolete_alerts
config disable_tcpopt_ttcp_alerts
config disable_tcpopt_alerts
config disable_ipopt_alerts

# --- Préprocesseurs essentiels ---
preprocessor frag3_global: max_frags 65536
preprocessor frag3_engine: policy linux detect_anomalies overlap_limit 10 min_fragment_length 100 timeout 180

preprocessor stream5_global: track_tcp yes, track_udp yes, track_icmp no, max_tcp 262144, max_udp 131072
preprocessor stream5_tcp: policy linux, detect_anomalies, require_3whs 180, overlap_limit 10, small_segments 3 bytes 150, timeout 180, ports client 21 22 23 25 42 53 80 110 111 135 136 137 139 143 445 513 514 1433 1521 2222 3306 3389, ports both 443 465 563 636 989 992 993 994 995 7801 7802 7900 7901 7902 7903 7904 7905 7906 7907 7908 7909 7910 7911 7912 7913 7914 7915 7916 7917 7918 7919 7920

# --- Sorties ---
output alert_fast: alerts.txt
output log_tcpdump: tcpdump.log

# --- Inclusion des règles ---
include /Users/macbook/Projects/secure-network-infrastructure/05_IDS_Snort/local.rules
